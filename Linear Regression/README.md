This file contains the code behind the lm function.